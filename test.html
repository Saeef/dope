<!doctype html>
<html class="rad ++" lang="en" data-movie-name="Pulp Fiction" data-genre="crime" data-producer="Bender">
<head>
    <meta charset=utf-8>
    <link rel=dns-prefetch href=//airve.github.com>

    <title>dope Test Suite</title>

    <meta name=viewport content="width=device-width,initial-scale=1.0">
    <meta name=description content="JavaScript module test suite"> 
    <meta name=author content="Ryan Van Etten">

    <link rel=stylesheet href="http://css3base.com/build/normalize,h5bp,responsive,rad,plus,print.20120916.css">

    <style>
        body{margin:1em auto;max-width:100%;width:94%;padding:0 3%}
        a{text-decoration:none;cursor:pointer}
        pre,td,th{padding:1em;text-align:left;/*border-left:1px solid #eed*/}
        td{font-weight:bold;/*color:#2aa198*/}
        td:first-child{font-weight:normal;/*color:#586e75*/}
        td:last-child{/*color:#dc322f*/}
        pre{padding:1em;/*background:#eee8d5*/}
        th{font-size:140%}
        #footer{margin:2em 0;border-bottom:1em solid #ffe}
        nav ul li{display:block;float:left;margin:0 0 1em}
        nav ul li a{padding:.5em;background:#653;color:#fff!important;margin:0 1px 1em 0}
        nav ul li a:hover{color:#653!important;background:#8d2}
        [accesskey=z]{visibility:hidden;width:0;height:0}
        .rad p{padding:1em}
    </style>

    <!-- Make sure to include the URI scheme (see uri5.com) in external
         URIs so that offline testing works in all browsers. -->
    
    <!--code.google.com/p/html5shiv/-->
    <!--[if lt IE 9]>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <!-- Host URIs ( test integration with all of these )
        http://airve.github.com/js/elo/elo.js
        http://airve.github.com/js/jeesh/jeesh.js
        http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.js
    -->

    <!-- 
        These can be loaded in any order. They're in the <head> here, but at deployment
        they should be @ bottom or loaded with an async loader (e.g. yepnopejs.com)
        The test suite code is inline @ bottom.
    -->
    <script src="http://airve.github.com/js/elo/elo.min.js"></script>
    <script src="http://airve.github.com/js/dj/dj.min.js"></script>
    <script src="http://airve.github.com/js/vibe/vibe.min.js"></script>
    <script src="dope.js"></script><!-- github.com/ryanve/dope  -->

</head>
<body>
    
    <header id="header">
        <h1><a href="http://github.com/ryanve/dope">dope</a> Test Suite</h1>
    </header>
    
    <pre id=ua></pre>

    <pre><code><strong>var</strong> docElem = document.documentElement;
<strong>var</strong> $html = $(docElem);
</code></pre>

    <!-- In the DOM all 3 test divs should have `data-vincent-vega` and `data-mia-wallace`: -->
    <!-- They should NOT have `data-butch-coolidge` or `data-jules-winnfield`: -->
    <div class="test"></div>
    <div class="test"></div>
    <div class="test"></div>
    
    <!--<figure>
        <img src="http://cdn.airve.com/image/pulp-fiction/jules_056_71_1920_vio.png" alt="Samuel Jackson as Jules Winnfield in Pulp Fiction">
    </figure>-->
    
    <table id=tests>
        <tr>
            <th scope="col"><a href=#tests accesskey=s>test<br>code</a></th>
            <th scope="col"><a href=#tests>correct<br>output</a></th>
            <th scope="col"><a href=#tests>actual<br>output</a></th>
        </tr>
        <tr>
            <td><code>$(<span class=string>'div'</span>).length</code></td>
            <td><code>3</code></td>
            <td><code id=select-tags></code></td>
        </tr>
        <tr>
            <td><code><strong>typeof</strong> $html.dataset()</code></td>
            <td><code>[object DOMStringMap]<br><strong>or</strong> [object Object]</code></td>
            <td><code id=dataset-to-string></code></td>
        </tr>
        <tr>
            <td><code>dope.camelize(<span class=string>'data-jack-rabbit-slims'</span>)</code></td>
            <td><code>jackRabbitSlims</code></td>
            <td><code id=camelize></code></td>
        </tr>
        <tr>
            <td><code>dope.camelize(<span class=string>'[data-jack-rabbit-slims]'</span>)</code></td>
            <td><code>jackRabbitSlims</code></td>
            <td><code id=camelize-bracks></code></td>
        </tr>
        <tr>
            <td><code>_.isEqual($html.dataset(), dope.dataset(docElem))</code></td>
            <td><code>true</code></td>
            <td><code id=dataset-object></code></td>
        </tr>
        <tr>
            <td><code>_.keys( $html.dataset() )</code></td>
            <td><code>movieName,genre,producer</code></td>
            <td><code id=keys></code></td>
        </tr>
        <tr>
            <td><code>$html.dataset(<span class=string>'movieName'</span>)</code></td>
            <td><code>Pulp Fiction</code></td>
            <td><code id=get-movie-name></code></td>
        </tr>
        <tr>
            <td><code>$html<br>.dataset(<span class=string>'director'</span>, <span class=string>'Tarantino'</span>)<br>.dataset(<span class=string>'director'</span>)</code></td>
            <td><code>Tarantino</code></td>
            <td><code id=set-director></code></td>
        </tr>
        <tr>
            <td><code>dope.dataset(docElem, 'year', 1994)</code></td>
            <td><code>1994</code></td>
            <td><code id=set-year></code></td>
        </tr>
        <tr>
            <td><code><span class=string>'1994'</span> <span class=operator>===</span> $html.dataset(<span class=string>'year'</span>)</code></td>
            <td><code>true</code></td>
            <td><code id=get-year></code></td>
        </tr>
        <tr>
            <td><code><span class=number>1994</span> <span class=operator>===</span> $html.dataset([<span class=string>'year'</span>])</code></td>
            <td><code>true</code></td>
            <td><code id=get-year-exact></code></td>
        </tr>
        <tr>
            <td><code><em class=boolean>true</em> <span class=operator>===</span> dope.parse(<span class=string>'true'</span>)</code></td>
            <td><code>true</code></td>
            <td><code id=parse-true></code></td>
        </tr>
        <tr>
            <td><code><span class=string>'number'</span> <span class=operator>===</span> typeof dope.parse(<span class=string>'NaN'</span>)</code></td>
            <td><code>true</code></td>
            <td><code id=parse-num></code></td>
        </tr>
        <tr>
            <td><code><span class=number>Infinity</span> <span class=operator>===</span> dope.parse('Infinity')</code></td>
            <td><code>true</code></td>
            <td><code id=parse-inf></code></td>
        </tr>
        <tr>
            <td><code>dope.deletes(docElem, 'genre producer')</code></td>
            <td><code>undefined</code></td>
            <td><code id=deletes></code></td>
        </tr>
        <tr>
            <td><code>$('div').dataset(<b>{</b>
              <br>&nbsp;&nbsp;&nbsp;&nbsp;vincentVega: <span class=string>'John Travolta'</span>
           <br>&nbsp;&nbsp;, miaWallace: <span class=string>'Uma Thurman'</span>
           <br>&nbsp;&nbsp;, butchCoolidge: <span class=string>'Bruce Willis'</span>
           <br>&nbsp;&nbsp;, julesWinnfield: <span class=string>'Samuel Jackson'</span>
          <br><b>}</b>).deletes(<span class=string>'butchCoolidge julesWinnfield'</span>)<br>&nbsp;&nbsp;.dataset(<span class=string>'miaWallace'</span>)</code></td>
            <td><code>Uma Thurman</code></td>
            <td><code id=set-multi></code></td>
        </tr>
        <!--<tr>
            <td><code>dope.toDataSelector(<b>[</b>'a', ' b', null, 'cD'<b>]</b>)</code></td>
            <td><code>[data-a],[data-b],[data-c-d]</code></td>
            <td><code id=to-data-selector-arr></code></td>
        </tr>
        <tr>
            <td><code>dope.toDataSelector('a  b,, cD'); <small>// <abbr title="comma-separated values">csv</abbr> or <abbr title="space-separated values">ssv</abbr></small></code></td>
            <td><code>[data-a],[data-b],[data-c-d]</code></td>
            <td><code id=to-data-selector-str></code></td>
        </tr>-->
        <tr>
            <td><code>dope.queryData('miaWallace').length</code></td>
            <td><code>3</code></td>
            <td><code id=query-data></code></td>
        </tr>
        <tr>
            <td><code>dope.queryData('miaWallace movieName').length</code></td>
            <td><code>4</code></td>
            <td><code id=query-data-multi></code></td>
        </tr>
        <tr>
            <td><code><strong>typeof</strong> $html.dataset('dne')</code></td>
            <td><code>undefined</code></td>
            <td><code id=dne></code></td>
        </tr>
    </table>
    
    <footer id="footer">
        <nav>
            <ul>
                <li><a href="#header" title="up" accesskey=a><span class=shape>&#9650;</span></a>
                <li><a href="https://github.com/ryanve/dope" title="view repo" accesskey=1>Github</a>
                <li><a href="https://github.com/ryanve/dope/issues" title="report an issue" accesskey=9>Issue?</a>
                <li><a href="#footer" title="down" accesskey=z>&#9660;</a>
            </ul>
        </nav>
        
    </footer>
    
    <a id="toggle" title="Toggle styles" accesskey="2">&#0926;</a>

    <!-- accesskeys: 
        1: homepage
        a: jump to top 
        z: jump to bottom 
        s: skip to main content
    -->

    <script>
    (function ( window, document, console, _, dj, dope, elo, jQuery, ender, vibe ) {

        var docElem = document.documentElement
          , $ = jQuery || elo || ender
          , toString = {}.toString
          , hasConsole = !!(console && console.log)
          , log = hasConsole ? function (s) {
                console.log(s); 
            } : function (s, force) { 
                force && alert(s); 
            }
          , id = function (id) {
                return document.getElementById(id);
            }
          , html = function (el, html) {
                el && 1 === el.nodeType && (el.innerHTML = html || '');
            };

            function keys (o, type) {
                var a = [], n;
                type = typeof type == 'string' && type;
                for ( n in o ) {
                    if ( !o.hasOwnProperty(n) ) { break; }
                    if ( !type || typeof o[a] === type ) { a.push(n); }
                }
                return a;
            }
            
            function isEqual (a, b) {
                var t = typeof a;
                if ( t != typeof b || ( a ? !b : b ) ) { 
                    return false; 
                }
                if ( a === b ? a === a : a !== a && b !== b ) { 
                    return true; 
                }
                if ( !a || !b || toString.call(a) != toString.call(b) ) { 
                    return false; 
                }
                if ( t != 'object' && t != 'function' ) { 
                    return false; 
                }
                for ( t in a ) {
                    if ( !isEqual( a[t], b[t] ) ) { 
                        return false;
                    }
                }
                return true;
            }
        
        // integrate dope into $
        dope.bridge ? dope.bridge($, true) : dj.bridge.call(dope, $, true);

        
        log( window );
        log( dj.resample(dope) ); // top-level props
        log( dj.resample($) ); // integrated
        
        elo.domReady(function (elo) {
            
            var $html = $(docElem)
              , props = {}
              , tests = {}
              , hostProps = {};
              
            elo('#toggle').on('click', function () {
                vibe.toggleClass(docElem, 'dark');
            });

            html(id('ua'), navigator.userAgent);

            // keep the tests in order b/c some of them rely on previous ones
            tests['select-tags'] = $('div').length;
            tests['empty-length'] = $('').length;
            tests['dataset-to-string'] = $html.dataset().toString();
            tests['camelize'] = dope.camelize( 'data-jack-rabbit-slims' );
            tests['camelize-bracks'] = dope.camelize( '[data-jack-rabbit-slims]' );
            tests['dataset-object'] = isEqual($html.dataset(), dope.dataset(docElem));
            tests['keys'] = keys( $html.dataset() );
            tests['get-movie-name'] = $html.dataset('movieName');
            tests['set-director'] = $html.dataset('director', 'Tarantino').dataset('director');
            //tests['set-director'] = dope.dataset(docElem, 'director', 'Tarantino');
            
            tests['set-year'] = dope.dataset(docElem, 'year', 1994);
            tests['get-year'] = '1994' === $html.dataset('year');
            tests['get-year-exact'] = 1994 === $html.dataset(['year']);
            //tests['get-year-exact'] = 1994 === dope.dataset(docElem, ['year']);
            tests['parse-true'] = true === dope.parse('true');
            tests['parse-num'] = 'number' === typeof dope.parse('NaN');
            tests['parse-inf'] = Infinity === dope.parse('Infinity');
            tests['deletes'] = dope.deletes(docElem, 'genre producer');
            //tests['dne'] = $html.dataset('dne');
            tests['dne'] = dope.dataset(docElem, 'dne');
            
            // IE7
            // alert (typeof $html.dataset('n', null).dataset('n'));
            // document.body.setAttribute('n', null);
            // alert (typeof document.body.getAttribute('n'));

            // set 4 via object, then delete 2 of them, then access 1 of the non-deleted ones:
            tests['set-multi'] = $('div').dataset({
                 vincentVega: 'John Travolta'
               , miaWallace: 'Uma Thurman'
               , butchCoolidge: 'Bruce Willis'
               , julesWinnfield: 'Samuel Jackson'
              }).deletes('butchCoolidge julesWinnfield')
                .dataset('miaWallace');
            
            //tests['to-data-selector-arr'] = dope.queryData(['a', ' b', null, 'cD'], false);
            //tests['to-data-selector-str'] = dope.queryData('a  b,, cD', false); // csv or ssv
            tests['query-data'] = dope.queryData('miaWallace').length;
            tests['query-data-multi'] = dope.queryData('miaWallace movieName').length;

            
            // print the test outputs
            elo.each(tests, function (v, k, tests) {
                html( id(k), String(v) );
            });
        
        });
        
    }(this, this.document, this.console, this._, this.dj, this.dope, this.elo, this.jQuery, this.ender, this.vibe ));
    </script>
</body> 
</html>








