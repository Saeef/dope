<!doctype html>
<!doctype html>
<html class="solarized" lang="en" data-movie-name="Pulp Fiction" data-genre="crime" data-producer="Bender">
<head>
	<meta charset=utf-8>
	<title>dope Test Suite</title>
	<meta name=viewport content="width=device-width,initial-scale=1.0">
	<link rel=stylesheet href="http://cdn.airve.com/css/packed/normalize_responsive_solarized.20120408.css">
	<meta name=author content="Ryan Van Etten">
	<meta name=description content="JavaScript library test suite"> 
	<style>
	body{margin:1em auto;max-width:100%;width:94%;padding:0 3%}
	a{text-decoration:none;cursor:pointer}
	pre,td,th{padding:1em;text-align:left;border-left:1px solid #eed}
	td{font-weight:bold;color:#2aa198}
	td:first-child{font-weight:normal;color:#586e75}
	td:last-child{color:#dc322f}
	pre{padding:1em;background:#eee8d5}
	th{font-size:140%}
	#footer{margin:2em 0;border-bottom:1em solid #ffe}
	nav ul li{display:block;float:left;margin:0 0 1em}
	nav ul li a{padding:.5em;background:#cb4b16;color:#fdf6e3!important;margin:0 1px 1em 0}
	nav ul li a:hover{color:#ffe;background:#b58900}
	[accesskey=z]{visibility:hidden;width:0;height:0}
	</style>

	<!--code.google.com/p/html5shiv/
	    The src URI must include a scheme for offline testing to work in old IE: 
	--><!--[if lt IE 9]>
		<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	
	<!-- Test hosts:
	     http://airve.github.com/js/jeesh/jeesh.min.js
	-->
	<script src="http://airve.github.com/js/jeesh/jeesh.min.js"></script>
</head>
<body>
	
	<header id="header">
		<h1><a href="http://github.com/ryanve/dope">dope</a> Test Suite</h1>
	</header>
	
	<pre id=ua></pre>
	<pre><code><strong>var</strong> docElem = document.documentElement; <small>// html element</small></code></pre>
	
	<!-- In the DOM all 3 test divs should have `data-vincent-vega` and `data-mia-wallace`: -->
  	<!-- They should NOT have `data-butch-coolidge` or `data-jules-winnfield`: -->
	<div class="test"></div>
	<div class="test"></div>
	<div class="test"></div>
	
	<table id=tests>
		<tr>
			<th scope="col"><a href=#tests accesskey=s>test<br>code</a></th>
			<th scope="col"><a href=#tests>correct<br>output</a></th>
			<th scope="col"><a href=#tests>actual<br>output</a></th>
		</tr>
		<tr>
			<td><code>dope() <strong>instanceof</strong> dope</code></td>
			<td><code>true</code></td>
			<td><code id=instanceof></code></td>
		</tr>
		<tr>
			<td><code>document.body === dope('body')[0]</code></td>
			<td><code>true</code></td>
			<td><code id=body-selector></code></td>
		</tr>
		<tr>
			<td><code>document.body === dope(document.body)[0]</code></td>
			<td><code>true</code></td>
			<td><code id=body-node></code></td>
		</tr>
		<tr>
			<td><code>document.body === dope([document.body])[0]</code></td>
			<td><code>true</code></td>
			<td><code id=body-list></code></td>
		</tr>
		<tr>
			<td><code>dope('').length</code></td>
			<td><code>0</code></td>
			<td><code id=empty-length></code></td>
		</tr>
		<tr>
			<td><code>dope('body').length</code></td>
			<td><code>1</code></td>
			<td><code id=body-length></code></td>
		</tr>
		<tr>
			<td><code>dope('div').length</code></td>
			<td><code>3</code></td>
			<td><code id=select-tags></code></td>
		</tr>
		<tr>
			<td><code><strong>typeof</strong> dope('html').dataset()</code></td>
			<td><code>object</code></td>
			<td><code id=typeof-dataset></code></td>
		</tr>
		<tr>
			<td><code>dope(docElem).dataset() == dope.dataset(docElem)</code></td>
			<td><code title="false in old IE is okay here (all the props still match)">true*</code></td>
			<td><code id=dataset-object></code></td>
		</tr>
		<tr>
			<td><code>'movieName' <strong>in</strong> dope('html')</code></td>
			<td><code>true</code></td>
			<td><code id=in></code></td>
		</tr>
		<tr>
			<td><code>dope('html').dataset('movieName')</code></td>
			<td><code>Pulp Fiction</code></td>
			<td><code id=get-movie-name></code></td>
		</tr>
		<tr>
			<td><code>dope('html')<br>.dataset('director', 'Tarantino')<br>.dataset('director')</code></td>
			<td><code>Tarantino</code></td>
			<td><code id=set-director></code></td>
		</tr>
		<tr>
			<td><code>dope.dataset(docElem, 'year', 1994).tagName</code></td>
			<td><code>HTML</code></td>
			<td><code id=set-year></code></td>
		</tr>
		<tr>
			<td><code>'1994' === dope('html').dataset('year')</code></td>
			<td><code>true</code></td>
			<td><code id=get-year></code></td>
		</tr>
		<tr>
			<td><code><span class=red>1994</span> === dope('html').dataset(['year'])</code></td>
			<td><code>true</code></td>
			<td><code id=get-year-exact></code></td>
		</tr>
		<tr>
			<td><code><span class=orange>true</span> === dope.render('true')</code></td>
			<td><code>true</code></td>
			<td><code id=render-true></code></td>
		</tr>
		<tr>
			<td><code><span class=cyan>'number'</span> === typeof dope.render('NaN')</code></td>
			<td><code>true</code></td>
			<td><code id=render-num></code></td>
		</tr>
		<tr>
			<td><code><span class=red>Infinity</span> === dope.render('Infinity')</code></td>
			<td><code>true</code></td>
			<td><code id=render-inf></code></td>
		</tr>
		<tr>
			<td><code>dope.deletes(docElem, 'genre producer').tagName</code></td>
			<td><code>HTML</code></td>
			<td><code id=deletes></code></td>
		</tr>
		<tr>
			<td><code>dope('div').dataset(<b>{</b>
		  	<br>&nbsp;&nbsp;&nbsp;&nbsp;vincentVega: <span class=string>'John Travolta'</span>
		   <br>&nbsp;&nbsp;, miaWallace: <span class=string>'Uma Thurman'</span>
		   <br>&nbsp;&nbsp;, butchCoolidge: <span class=string>'Bruce Willis'</span>
		   <br>&nbsp;&nbsp;, julesWinnfield: <span class=string>'Samuel Jackson'</span>
		  <br><b>}</b>).deletes(<span class=string>'butchCoolidge julesWinnfield'</span>)<br>&nbsp;&nbsp;.dataset(<span class=string>'miaWallace'</span>)</code></td>
			<td><code>Uma Thurman</code></td>
			<td><code id=set-multi></code></td>
		</tr>
		<tr>
			<td><code>dope.toDataSelector(<b>[</b>'a', ' b', null, 'cD'<b>]</b>)</code></td>
			<td><code>[data-a],[data-b],[data-c-d]</code></td>
			<td><code id=to-data-selector-arr></code></td>
		</tr>
		<tr>
			<td><code>dope.toDataSelector('a  b,, cD'); <small>// <abbr title="comma-separated values">csv</abbr> or <abbr title="space-separated values">ssv</abbr></small></code></td>
			<td><code>[data-a],[data-b],[data-c-d]</code></td>
			<td><code id=to-data-selector-str></code></td>
		</tr>
		<tr>
			<td><code>dope.queryData('miaWallace').length</code></td>
			<td><code>3</code></td>
			<td><code id=query-data></code></td>
		</tr>
		<tr>
			<td><code>dope.queryData('miaWallace movieName').length</code></td>
			<td><code>4</code></td>
			<td><code id=query-data-multi></code></td>
		</tr>
		<tr>
			<td><code><strong>typeof</strong> dope('html').data('dne')</code></td>
			<td><code>undefined</code></td>
			<td><code id=dne></code></td>
		</tr>
	</table>
	
	<footer id="footer">
		<nav>
			<ul>
				<li><a href="#header" title="up" accesskey=a><span class=shape>&#9650;</span></a>
				<li><a href="https://github.com/ryanve/dope" title="view repo" accesskey=1>Github</a>
				<li><a href="https://github.com/ryanve/dope/issues" title="report an issue" accesskey=9>Issue?</a>
				<li><a href="#footer" title="down" accesskey=z>&#9660;</a>
			</ul>
		</nav>
		
	</footer>

	<!-- accesskeys: 
		1: homepage
		a: jump to top 
		z: jump to bottom 
		s: skip to main content
	-->

	<script>
		// Make a dummy fn object to test that dope.bridge() works:
		// this.$ = this.$ || function() {};
		// $.fn = $.fn || {};
	</script>
	
	<!-- 
	  <script src="http://airve.github.com/js/elo/elo.min.js"></script>
	-->
	<script src="dope.js"></script><!-- github.com/ryanve/dope  -->

	<script>
	(function(document, console, dope) {

		var n, props = {}, tests = {}, hostProps = {}
		  , docElem = document.documentElement;

		// user agent string:
		document.getElementById('ua').innerHTML = navigator.userAgent || '';

		// keep the tests in order b/c some of them rely on previous ones
		tests['instanceof'] = dope() instanceof dope;
		tests['body-selector'] = document.body === dope('body')[0];
		tests['body-node'] = document.body === dope(document.body)[0];
		tests['body-list'] = document.body === dope([document.body])[0];
		tests['body-length'] = dope('body').length;
		tests['select-tags'] = dope('div').length;
		tests['empty-length'] = dope('').length;
		tests['typeof-dataset'] = typeof dope('html').dataset();
		tests['dataset-object'] = dope(docElem).dataset() == dope.dataset(docElem);
		tests['in'] = 'movieName' in dope('html').dataset();
		tests['get-movie-name'] = dope('html').dataset('movieName');
		tests['set-director'] = dope('html').dataset('director', 'Tarantino').dataset('director');
		tests['set-year'] = dope.dataset(docElem, 'year', 1994).tagName;
		tests['get-year'] = '1994' === dope('html').dataset('year');
		tests['get-year-exact'] = 1994 === dope('html').dataset(['year']);
		tests['render-true'] = true === dope.render('true');
		tests['render-num'] = 'number' === typeof dope.render('NaN');
		tests['render-inf'] = Infinity === dope.render('Infinity');
		tests['deletes'] = dope.deletes(docElem, 'genre producer').tagName;
		tests['dne'] = dope('html').dataset('dne');

		// IE7
		// alert (typeof dope('html').dataset('n', null).dataset('n'));
		// document.body.setAttribute('n', null);
		// alert (typeof document.body.getAttribute('n'));

		// set 4 via object, then delete 2 of them, then access 1 of the non-deleted ones:
		tests['set-multi'] = dope('div').dataset({ 
		  	 vincentVega: 'John Travolta'
		   , miaWallace: 'Uma Thurman'
		   , butchCoolidge: 'Bruce Willis'
		   , julesWinnfield: 'Samuel Jackson'
		  }).deletes('butchCoolidge julesWinnfield')
		    .dataset('miaWallace');
		
		tests['to-data-selector-arr'] = dope.toDataSelector(['a', ' b', null, 'cD']);
		tests['to-data-selector-str'] = dope.toDataSelector('a  b,, cD'); // csv or ssv
		tests['query-data'] = dope.queryData('miaWallace').length;
		tests['query-data-multi'] = dope.queryData('miaWallace movieName').length;

		// print the test outputs:
		for (n in tests) {
			if (tests.hasOwnProperty(n)) {
				document.getElementById(n).innerHTML = tests[n];
			}
		}

		if (console && typeof console.log === 'function') {// use console.log in here:
			console.log($.mapFilter($.toArray('a  b,, cD'), $.datatize));
			//dope.bridge($);
			if ([].forEach && Object.keys) {
				Object.keys(dope).forEach(function(v){
					props[v] = dope[v];
				});
				Object.keys($).forEach(function(v){
					hostProps [v] = $[v];
				});
			}
			console.log(props); // top-level props
			console.log(hostProps); // integrated
			dope(function(d){ console.log([this === document, d === dope, d() instanceof dope]); });
			console.log([dope.fn === dope.prototype, dope.dope === dope, dope() instanceof dope]);
			
		}

	}(this.document, this.console, this.dope));
	</script>
</body> 
</html>